generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Classification {
  id         Int      @id @default(autoincrement())
  name       String   @unique(map: "classification_name") @db.VarChar(30)
  created_at DateTime @default(now()) @db.Timestamp(0)
  updated_at DateTime @default(now()) @db.Timestamp(0)
  recipes    Recipe[]

  @@map("classifications")
}

model Source {
  id         Int      @id @default(autoincrement())
  name       String   @unique(map: "source_name") @db.VarChar(50)
  created_at DateTime @default(now()) @db.Timestamp(0)
  updated_at DateTime @default(now()) @db.Timestamp(0)
  recipes    Recipe[]

  @@map("sources")
}

model Meal {
  id           Int          @id @default(autoincrement())
  name         String       @unique(map: "meal_name") @db.VarChar(20)
  created_at   DateTime     @default(now()) @db.Timestamp(0)
  updated_at   DateTime     @default(now()) @db.Timestamp(0)
  recipe_meals RecipeMeal[]

  @@map("meals")
}

model Course {
  id             Int            @id @default(autoincrement())
  name           String         @unique(map: "course_name") @db.VarChar(20)
  created_at     DateTime       @default(now()) @db.Timestamp(0)
  updated_at     DateTime       @default(now()) @db.Timestamp(0)
  recipe_courses RecipeCourse[]

  @@map("courses")
}

model Preparation {
  id                  Int                 @id @default(autoincrement())
  description         String              @unique(map: "preparation_description") @db.VarChar(15)
  created_at          DateTime            @default(now()) @db.Timestamp(0)
  updated_at          DateTime            @default(now()) @db.Timestamp(0)
  recipe_preparations RecipePreparation[]

  @@map("preparations")
}

model Recipe {
  id                  Int                 @id @default(autoincrement())
  name                String              @unique(map: "recipe_name") @db.VarChar(50)
  ingredients         String?             @db.Text
  instructions        String?             @db.Text
  notes               String?             @db.Text
  servings            Int?                @default(0)
  source_id           Int?                @default(0)
  classification_id   Int?                @default(0)
  date_added          DateTime?           @db.DateTime(0)
  calories            String?             @db.VarChar(50)
  fat                 String?             @db.VarChar(50)
  cholesterol         String?             @db.VarChar(50)
  sodium              String?             @db.VarChar(50)
  protein             String?             @db.VarChar(50)
  marked              Boolean?
  created_at          DateTime            @default(now()) @db.Timestamp(0)
  updated_at          DateTime            @default(now()) @db.Timestamp(0)
  cookbook_recipes    CookbookRecipe[]
  recipe_courses      RecipeCourse[]
  recipe_meals        RecipeMeal[]
  recipe_preparations RecipePreparation[]
  classifications     Classification?     @relation(fields: [classification_id], references: [id], onDelete: NoAction, map: "fk_recipes_classification_id")
  sources             Source?             @relation(fields: [source_id], references: [id], onDelete: NoAction, map: "fk_recipes_source_id")

  @@index([classification_id], map: "classification_id")
  @@index([source_id], map: "source_id")
  @@map("recipes")
}

model RecipeMeal {
  id         Int      @id @default(autoincrement())
  recipe_id  Int      @default(0)
  meal_id    Int      @default(0)
  created_at DateTime @default(now()) @db.Timestamp(0)
  updated_at DateTime @default(now()) @db.Timestamp(0)
  meals      Meal     @relation(fields: [meal_id], references: [id], onDelete: NoAction, map: "fk_recipe_meal_pivot_meal_id")
  recipes    Recipe   @relation(fields: [recipe_id], references: [id], onDelete: NoAction, map: "fk_recipe_meal_pivot_recipe_id")

  @@index([meal_id], map: "meal_id")
  @@index([recipe_id], map: "recipe_id")
  @@map("recipe_meals")
}

model RecipeCourse {
  id         Int      @id @default(autoincrement())
  recipe_id  Int      @default(0)
  course_id  Int      @default(0)
  created_at DateTime @default(now()) @db.Timestamp(0)
  updated_at DateTime @default(now()) @db.Timestamp(0)
  courses    Course   @relation(fields: [course_id], references: [id], onDelete: NoAction, map: "fk_recipe_course_pivot_course_id")
  recipes    Recipe   @relation(fields: [recipe_id], references: [id], onDelete: NoAction, map: "fk_recipe_course_pivot_recipe_id")

  @@index([course_id], map: "course_id")
  @@index([recipe_id], map: "recipe_id")
  @@map("recipe_courses")
}

model RecipePreparation {
  id             Int         @id @default(autoincrement())
  recipe_id      Int         @default(0)
  preparation_id Int         @default(0)
  created_at     DateTime    @default(now()) @db.Timestamp(0)
  updated_at     DateTime    @default(now()) @db.Timestamp(0)
  preparations   Preparation @relation(fields: [preparation_id], references: [id], onDelete: NoAction, map: "fk_recipe_preparation_pivot_meal_id")
  recipes        Recipe      @relation(fields: [recipe_id], references: [id], onDelete: NoAction, map: "fk_recipe_preparation_pivot_recipe_id")

  @@index([preparation_id], map: "preparation_id")
  @@index([recipe_id], map: "recipe_id")
  @@map("recipe_preparations")
}

model Cookbook {
  id               Int              @id @default(autoincrement())
  name             String?          @unique(map: "cookbook_name") @db.VarChar(255)
  created_at       DateTime         @default(now()) @db.Timestamp(0)
  updated_at       DateTime         @default(now()) @db.Timestamp(0)
  cookbook_recipes CookbookRecipe[]

  @@map("cookbooks")
}

model CookbookRecipe {
  id          Int      @id @default(autoincrement())
  cookbook_id Int      @default(0)
  recipe_id   Int      @default(0)
  created_at  DateTime @default(now()) @db.Timestamp(0)
  updated_at  DateTime @default(now()) @db.Timestamp(0)
  cookbooks   Cookbook @relation(fields: [cookbook_id], references: [id], onDelete: NoAction, map: "fk_cookbook_recipe_pivot_cookbook_id")
  recipes     Recipe   @relation(fields: [recipe_id], references: [id], onDelete: NoAction, map: "fk_cookbook_recipe_pivot_recipe_id")

  @@index([cookbook_id], map: "fk_cookbook_id")
  @@index([recipe_id], map: "fk_recipe_id")
  @@map("cookbook_recipes")
}
